{{/* invoice.tmpl */}}
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>{{.InvoiceNumber}}</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: "Liberation Sans", "Noto Sans",Arial,sans-serif; font-size:11px; line-height:1.4; color:#000; background:#fff; }
    .page { width:100%; min-height:100vh; page-break-after:always; padding: 0 60px;}
    .page:last-child { page-break-after:avoid; }
    .header { display:flex; align-items:space-between;align-items: center;   margin-bottom:20px; gap: 60px;   }
    .logo { width:180px; margin-right:30px; }
    .logo img {  flex-shrink: 0; width:200px;display: flex; justify-content: center; align-items: center; object-fit:contain; }
    .logo img { width: 100%; height: auto; }
    .company-info { flex:1; }
    .company-name { font-size:30px; font-weight:bold; margin-bottom:8px; }
    .info-table { width:100%; border-collapse:collapse; }
    .info-table td:first-child { width:60px; font-weight:bold; }
    .info-table td { padding: 4px 0; vertical-align:top; padding-bottom:2px; font-size:14px; }
    .info-table td + td { padding-left: 8px; }
    .invoice-title {
      text-align:center; font-size:16px; font-weight:bold;
      margin:15px 0; padding:8px 0;
      border-top:2px solid #000; border-bottom:2px solid #000;
    }
    .customer-section { width:100%; border-collapse:collapse; margin: 0 auto 15px; }
    .customer-section td { vertical-align:top; padding:0; }
    .customer-section td:first-child { padding-right:25px; white-space: nowrap;}
    .customer-table { width:100%; border-collapse:collapse; }
    .customer-table td:first-child { width:110px; font-weight:bold; }
    .customer-table td { padding-bottom:2px; font-size:11px; }
    .products-table { width:100%; border-collapse:collapse; margin-bottom:12px; }
    .products-table thead { display:table-header-group; }
    .products-table th, .products-table td {
      padding:6px 4px; vertical-align:middle;
    }
    .products-table th {
      font-weight:bold; border-bottom:2px solid #000;
    }
    .products-table td {
      border-top:1px solid #000; border-bottom:1px solid #000;
    }
    .products-table td:first-child, .products-table th:first-child {
      text-align:left; width:70px;
    }
    .products-table td:nth-child(2), .products-table th:nth-child(2) {
      text-align:left;
    }
    .djj-code { color: #cc6600; font-weight:500; }
    .qty-cell { text-align:center; width:35px; font-weight:bold; }
    .location-cell {text-align: center;}
    .price-cell { text-align:right; }
    .total-section { text-align:right; margin-bottom:20px; }
    .total-table {
      margin-left: auto;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 11px;
    }

    /* 清除所有单元格的 border 并统一内边距、右对齐 */
    .total-table td {
      border: none;
      padding: 6px 12px;
      text-align: right;
    }

    /* 默认：最后一列白底 */
    .total-table td:last-child {
      background: #fff;
    }

    /* 第一列——“Subtotal:” 等标签列，统一橙色加粗 */
    .total-table td:first-child {
      color: #e09021;
      font-weight: bold;
    }

    /* 第一行值列（Subtotal）灰底，文字常规 */
    .total-table tr:nth-child(1) td:last-child {
      background: #e3dfdf;
      font-weight: normal;
    }

    /* 第二行值列（GST）白底，文字常规——其实可以省，因为我们默认就是白底 */
    .total-table tr:nth-child(2) td:last-child {
      background: #fff;
      font-weight: normal;
    }

    /* 第三行值列（Total）灰底，文字加粗 */
    .total-table tr:nth-child(3) td:last-child {
      background: #e3dfdf;
      font-weight: bold;
    }
    .qty-total { text-align:right; margin-bottom:20px; font-size:11px; }
    .qty-label { font-weight:bold; color:#e09021; }
    .qty-value {
      font-weight:bold; font-size:12px; background:#e3dfdf;
      padding:3px 6px; border:1px solid #ccc;
    }
    .terms { margin-bottom:20px; }
    .terms h3 { font-weight:bold; margin-bottom:8px; font-size:12px; color:#cc6600; }
    .terms-content { font-size:9px; line-height:1.3; }
    .terms-item { margin-bottom:6px; }
    .payment-details { border-top:1px solid #000; padding-top:12px; }
    .payment-details h3 { font-weight:bold; margin-bottom:8px; font-size:11px; }
    .payment-table { font-size:10px; border-collapse:collapse; }
    .payment-table td:first-child { width:70px; font-weight:bold; padding-bottom:1px; }
    .payment-table td:last-child { padding-bottom:1px; }
    @media print {
      .page { page-break-after: always; }
      .page:last-child { page-break-after: avoid; }
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- Header -->
    <div class="header">
      <div class="logo">
        <img src="data:image/png;base64,{{.LogoBase64}}" alt="Logo">
      </div>
      <div class="company-info">
        <div class="company-name">{{.CompanyName}}</div>
        <table class="info-table">
          <tr><td>Email:</td><td> {{.CompanyEmail}}</td></tr>
          <tr><td>Phone:</td><td> {{.CompanyPhone}}</td></tr>
          <tr><td>Website:</td><td> {{.CompanyWebsite}}</td></tr>
          <tr><td>ABN:</td><td> {{.CompanyABN}}</td></tr>
          <tr><td>Address:</td><td> {{.CompanyAddress}}</td></tr>
        </table>
      </div>
    </div>

    <!-- Title -->
    <div class="invoice-title">{{.InvoiceType}}</div>

    <!-- Customer Info -->
    <table class="customer-section">
      <tr>
        <td>
          <table class="customer-table">
            <tr><td>Billing Address:</td><td>{{.BillingAddress}}</td></tr>
            <tr><td>Company:</td><td>{{.CustomerCompany}}</td></tr>
            <tr>
              <td>{{if .IsQuote}}Quote Number:{{else}}Invoice Number:{{end}}</td>
              <td>{{.InvoiceNumber}}</td>
            </tr>
            <tr><td>Contact:</td><td>{{.CustomerContact}}</td></tr>
            <tr><td>Email:</td><td>{{.CustomerEmail}}</td></tr>
          </table>
        </td>
        <td>
          <table class="customer-table">
            <tr><td>Delivery Address:</td><td>{{.DeliveryAddress}}</td></tr>
            <tr><td>ABN:</td><td>{{.CustomerABN}}</td></tr>
            <tr>
              <td>{{if .IsQuote}}Quote Date:{{else}}Invoice Date:{{end}}</td>
              <td>{{.InvoiceDate}}</td>
            </tr>
            <tr><td>Phone:</td><td>{{.CustomerPhone}}</td></tr>
            <tr><td>Sales Rep:</td><td>{{.SalesRep}}</td></tr>
          </table>
        </td>
      </tr>
    </table>

    <!-- Products -->
    <table class="products-table">
      <thead>
        <tr>
          <th>DJJ Code</th>
          <th>Product / Description</th>
          <th>VIN</th>
          <th>Qty.</th>
          {{if .IsQuote}}
            <th>Unit Price</th><th>Discount</th><th>Subtotal</th>
          {{else}}
            <th>Location</th>
          {{end}}
        </tr>
      </thead>
      <tbody>
        {{range .Items}}
        <tr>
          <td  class="djj-code">{{.DjjCode}}</td>
          <td>
            <div>{{.Description}}</div>
            {{if .DetailDescription}}
            <div style="font-size:9px; white-space:pre-line">{{.DetailDescription}}</div>
            {{end}}
          </td>
          <td style="white-space:pre-line">{{.VinEngine}}</td>
          <td class="qty-cell">{{.Quantity}}</td>
          {{if $.IsQuote}}
            <td class="price-cell">{{printf "$%.2f" .UnitPrice}}</td>
            <td class="price-cell">{{printf "$%.2f" .Discount}}</td>
            <td class="price-cell">{{printf "$%.2f" .Subtotal}}</td>
          {{else}}
            <td class="location-cell">{{.Location}}</td>
          {{end}}
        </tr>
        {{end}}
      </tbody>
    </table>

    <!-- Totals -->
    {{if .IsQuote}}
      <div class="total-section">
        <table class="total-table">
          <tr><td>Subtotal:</td><td>{{printf "$%.2f" .SubtotalAmount}}</td></tr>
          <tr><td>GST:</td><td>{{printf "$%.2f" .GSTAmount}}</td></tr>
          <tr><td>Total:</td><td>{{printf "$%.2f" .TotalAmount}}</td></tr>
        </table>
      </div>
    {{else}}
      <div class="qty-total">
        <span class="qty-label">Total Qty:</span>
        <span class="qty-value">{{.TotalQuantity}}</span>
      </div>
    {{end}}

    <!-- Terms & Conditions -->
    <div class="terms">
      <h3>Terms & Conditions:</h3>
      <div class="terms-content">
        <div class="terms-item">
          <strong>Acceptance</strong>
          <div>• Payment of any amount confirms acceptance of these Terms and forms a binding agreement.</div>
        </div>
        <div class="terms-item">
          <strong>Payment</strong>
          <div>• A deposit is required to confirm the order.</div>
          <div>• Deposits are non-refundable, unless otherwise agreed in writing in advance.</div>
          <div>• Full payment must be received before dispatch.</div>
        </div>
        <div class="terms-item">
          <strong>Cancellation</strong>
          <div>• If the order is cancelled after confirmation, DJJ Equipment may charge reasonable costs incurred.</div>
        </div>
        <div class="terms-item">
          <strong>Order Changes</strong>
          <div>• Changes must be approved in writing.</div>
          <div>• May result in additional charges or revised timelines.</div>
        </div>
        <div class="terms-item">
          <strong>Pricing</strong>
          <div>• Subject to change based on supplier pricing, import duties, and exchange rates prior to delivery.</div>
        </div>
      </div>
    </div>

    <!-- Payment Details -->
    <div class="payment-details">
      <h3>EFT Payment Details:</h3>
      <table class="payment-table">
        <tr><td>Name:</td><td>{{.BankName}}</td></tr>
        <tr><td>BSB:</td><td>{{.BSB}}</td></tr>
        <tr><td>Acct No.:</td><td>{{.AccountNumber}}</td></tr>
        <tr><td>Ref.:</td><td>{{.InvoiceNumber}}</td></tr>
      </table>
    </div>

  </div>
</body>
</html>
